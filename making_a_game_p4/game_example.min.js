if(b4w.module_check("example2_main"))throw"Failed to register module: example2_main";
b4w.register("example2_main",function(ba,c){function K(){}function L(){}function M(){}function N(){}function O(){}function P(){}function ca(a,g){if(g){var b=I.get_std_assets_path()+"tutorials/making_a_game_p4/game_example.json";da.load(b,ea)}else console.log("b4w init failure")}function ea(){k=e.get_object_by_name("character");e.get_object_by_dupli_name("character","character_collider");m=e.get_object_by_dupli_name("character","character_rig");poscontrol=e.get_object_by_name("poscontrol");R=e.get_object_by_name("camtarget");
_cam_target_2=e.get_object_by_name("camtarget2");_cam_target_3=e.get_object_by_name("camtarget3");var b=a.create_custom_sensor(0),g=a.create_custom_sensor(0),Q=a.create_custom_sensor(0),c=a.create_custom_sensor(0),h=a.create_custom_sensor(0);S()&&fa(b,Q,g,c,h);ga(Q,c);ha(b,g);ia(h);ja();T(0);r.id="left_div_id";r.style.position="relative";r.style.width="50%";r.style.cssFloat="left";r.style.color="#00ba0f";r.style.fontSize="30px";r.style.fontFamily="sans-serif";r.style.fontWeight="900";document.body.appendChild(r);
q.id="left_div2_id";q.style.position="relative";q.style.width="50%";q.style.cssFloat="left";q.style.color="#42f4ee";q.style.fontSize="30px";q.style.fontFamily="sans-serif";q.style.fontWeight="900";document.body.appendChild(q);t.id="left_div3_id";t.style.position="relative";t.style.width="50%";t.style.cssFloat="left";t.style.color="#04ff00";t.style.fontSize="30px";t.style.fontFamily="sans-serif";t.style.fontWeight="900";document.body.appendChild(t);u.id="left_div4_id";u.style.position="relative";u.style.width=
"50%";u.style.cssFloat="left";u.style.color="#ffe900";u.style.fontSize="30px";u.style.fontFamily="sans-serif";u.style.fontWeight="900";document.body.appendChild(u);v.id="left_div5_id";v.style.position="relative";v.style.width="50%";v.style.cssFloat="left";v.style.color="#ff6a00";v.style.fontSize="30px";v.style.fontFamily="sans-serif";v.style.fontWeight="900";document.body.appendChild(v);w.id="left_div6_id";w.style.position="relative";w.style.width="50%";w.style.cssFloat="left";w.style.color="#ff0000";
w.style.fontSize="30px";w.style.fontFamily="sans-serif";w.style.fontWeight="900";document.body.appendChild(w);b=e.get_object_by_name("boat");f.move_local(b,0,0,.1);e.get_object_by_name("Cone");ka[0]=.1;b=e.get_object_by_name("GameReference");a.create_sensor_manifold(b,"MAIN",a.CT_CONTINUOUS,[U],null,la);b=ma.get_canvas();b.addEventListener("mousedown",V,!1);b.addEventListener("touchstart",V,!1)}function V(a){if(document.a&&null!==document.a||!document.mozFullScreen&&!document.webkitIsFullScreen)document.documentElement.a?
document.documentElement.a():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);a.preventDefault&&a.preventDefault();var b=W.get_coords_x(a);a=W.get_coords_y(a);(b=z.pick_object(b,a))&&"boat"==e.get_object_name(b)&&(null==l?(l=b,b=X=e.get_object_by_name("boatattach"),f.get_translation(k,D),f.set_translation(b,D[0],D[1],D[2]),A.append_stiff(k,
X)):(l=null,f.get_translation(k,na),A.remove(k,!1)))}function oa(a,g){var b=a[2];.8>b&&(b=.8,g[2]=b);1>b&&(b+=.001);g[2]=b}function pa(a,g){g[0]=.2;g[1]=-.2}function qa(a,g){g[0]=2;g[1]=-2}function ra(){}function K(){E.append_custom_callback("alter_ocean_node",ra)}function L(){E.append_custom_callback("alter_ocean_node",pa)}function M(){E.append_custom_callback("alter_ocean_node",qa)}function N(){E.append_custom_callback("alter_ocean_node",oa)}function O(){var a=e.get_object_by_name("land col.001");
f.move_local(a,1,0,0)}function P(){var a=e.get_object_by_name("land col.001");f.move_local(a,-1,0,0)}function la(){var a=sa.get_timeline();x=a-Y;Y=a;f.move_local(k,0,.1*F*x*16,0);a=e.get_object_by_name("dummy");obj=k;f.get_translation(obj,n);y.copy(n,B);y.copy(n,ta);n[2]+=1;B[2]-=10;ua.append_ray_test_ext(null,n,B,"ANY",va,!0,!1,!0,!1);f.get_translation(a,B);f.get_translation(obj,n);Z?J=0:1<=J||(J+=1);Z=0;null!=l&&f.move_local(l,0,G*x*5,0);if(null!=k){var g=e.get_object_by_name("oceanflat"),a=e.get_object_by_name("ocean"),
c=e.get_object_by_name("nearestterrain");temp1_pos=f.get_translation(k);temp2_pos=f.get_translation(c);temp1_pos[2]=0;temp2_pos[2]=0;d=y.distance(temp1_pos,temp2_pos);160>d?(z.hide_object(a,void 0),z.show_object(g,void 0)):(z.show_object(a,void 0),z.hide_object(g,void 0));f.move_local(a,0,-.05*x,0);f.move_local(a,-.05*x,0,0);char_pos=f.get_translation(k);ocean_pos=f.get_translation(a);g=char_pos[0]-ocean_pos[0];c=char_pos[1]-ocean_pos[1];-100>c&&f.move_local(a,0,-100,0);100<c&&f.move_local(a,0,100,
0);-100>g&&f.move_local(a,-100,0,0);100<g&&f.move_local(a,100,0,0)}}function va(a,g,c,h,l){f.get_translation(k,n);f.set_translation(k,n[0],n[1],l[2]);aa[2]=l[2];a=e.get_object_by_name("dummy");z.hide_object(a,void 0);f.set_translation(a,n[0],n[1],aa[2])}function ga(b,g){function f(a,g,b){if(null==l){if(1==b)switch(g){case "FORWARD":F=-1;p.apply(m,"character_run_B4W_BAKED");break;case "BACKWARD":F=1,p.apply(m,"character_run_B4W_BAKED")}else F=0,p.apply(m,"character_idle_01_B4W_BAKED");p.play(m);p.set_behavior(m,
p.AB_CYCLIC)}else if(1==b)switch(g){case "FORWARD":G=1;break;case "BACKWARD":G=-1}else G=0}function c(a,g,b){if(1==b)switch(g){case "MW_FORWARD":H+=1,3<H&&(H=0),T(H)}}var e=a.create_keyboard_sensor(a.KEY_W),h=a.create_keyboard_sensor(a.KEY_S),n=a.create_keyboard_sensor(a.KEY_UP),wa=a.create_keyboard_sensor(a.KEY_DOWN),C=a.create_mouse_wheel_sensor();a.create_keyboard_sensor(a.KEY_O);var xa=a.create_keyboard_sensor(a.KEY_P),ya=a.create_keyboard_sensor(a.KEY_L),e=[e,n,b,h,wa,g],C=[C,xa,b,C,ya,g];a.create_sensor_manifold(k,
"FORWARD",a.CT_TRIGGER,e,function(a){return a[0]||a[1]||a[2]},f);a.create_sensor_manifold(k,"BACKWARD",a.CT_TRIGGER,e,function(a){return a[3]||a[4]||a[5]},f);a.create_sensor_manifold(k,"MW_FORWARD",a.CT_TRIGGER,C,function(a){return a[0]||a[1]||a[2]},c);a.create_sensor_manifold(k,"MW_BACKWARD",a.CT_TRIGGER,C,function(a){return a[3]||a[4]||a[5]},c);p.apply(m,"character_idle_01_B4W_BAKED");p.play(m);p.set_behavior(m,p.AB_CYCLIC)}function ha(b,g){function c(g,b,e){var c=a.get_sensor_value(g,"LEFT",6);
if(null==l){if(1==e)switch(b){case "LEFT":f.rotate_z_local(g,6*x*.6);break;case "RIGHT":f.rotate_z_local(g,6*x*-.6)}}else if(1==e)switch(b){case "LEFT":rot=f.get_rotation_euler(l);f.set_rotation_euler(l,rot[0],rot[1],rot[2]+6*c);break;case "RIGHT":rot=f.get_rotation_euler(l),f.set_rotation_euler(l,rot[0],rot[1],rot[2]-6*c)}}var e=a.create_keyboard_sensor(a.KEY_A),h=a.create_keyboard_sensor(a.KEY_D),n=a.create_keyboard_sensor(a.KEY_LEFT),p=a.create_keyboard_sensor(a.KEY_RIGHT),e=[e,n,g,h,p,b,U];a.create_sensor_manifold(k,
"LEFT",a.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},c);a.create_sensor_manifold(k,"RIGHT",a.CT_CONTINUOUS,e,function(a){return a[3]||a[4]||a[5]},c)}function ia(b){var g=a.create_keyboard_sensor(a.KEY_SPACE);a.create_sensor_manifold(k,"JUMP",a.CT_SHOT,[g,b],function(a){return a[0]||a[1]},function(){})}function ja(){var b=a.create_keyboard_sensor(a.KEY_1);a.create_sensor_manifold(null,"KEY1",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){K()});b=a.create_keyboard_sensor(a.KEY_2);
a.create_sensor_manifold(null,"KEY2",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){L()});b=a.create_keyboard_sensor(a.KEY_3);a.create_sensor_manifold(null,"KEY3",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){M()});b=a.create_keyboard_sensor(a.KEY_4);a.create_sensor_manifold(null,"KEY4",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){N()});b=a.create_keyboard_sensor(a.KEY_5);a.create_sensor_manifold(null,"KEY5",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){O()});
b=a.create_keyboard_sensor(a.KEY_6);a.create_sensor_manifold(null,"KEY6",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){P()})}function fa(b,g,e,c,f){function h(h){h.preventDefault();h=h.changedTouches;for(var k=0;k<h.length;k++)h[k].identifier==n?(a.set_custom_sensor(g,0),a.set_custom_sensor(c,0),a.set_custom_sensor(e,0),a.set_custom_sensor(b,0),p.style.visibility="hidden",m.style.visibility="hidden",n=null):h[k].identifier==l&&(a.set_custom_sensor(f,0),l=null)}var k=new Float32Array(2),
n,l,p=document.getElementById("control_tap"),m=document.getElementById("control_circle"),r=p.clientWidth/2,q=m.clientWidth/2;document.getElementById("canvas3d").addEventListener("touchstart",function(a){a.preventDefault();var b=window.innerWidth;a=a.changedTouches;for(var g=0;g<a.length;g++){var e=a[g],c=e.clientX,f=e.clientY;if(c>b/2)break;k[0]=c;k[1]=f;n=e.identifier;p.style.visibility="visible";p.style.left=c-r+"px";p.style.top=f-r+"px";m.style.visibility="visible";m.style.left=c-q+"px";m.style.top=
f-q+"px"}},!1);document.getElementById("control_jump").addEventListener("touchstart",toggleFullScreen(document.body),!1);document.getElementById("canvas3d").addEventListener("touchmove",function(f){f.preventDefault();a.set_custom_sensor(g,0);a.set_custom_sensor(c,0);a.set_custom_sensor(e,0);a.set_custom_sensor(b,0);var h=window.innerWidth;f=f.changedTouches;for(var n=0;n<f.length;n++){var l=f[n],m=l.clientX,l=l.clientY;if(m>h/2)break;p.style.left=m-r+"px";p.style.top=l-r+"px";var m=m-k[0],l=l-k[1],
q=Math.sqrt(m*m+l*l);if(16>q)break;m/=q;l=-l/q;m>Math.cos(3*Math.PI/8)?a.set_custom_sensor(b,1):m<-Math.cos(3*Math.PI/8)&&a.set_custom_sensor(e,1);l>Math.sin(Math.PI/8)?a.set_custom_sensor(g,1):l<-Math.sin(Math.PI/8)&&a.set_custom_sensor(c,1)}},!1);document.getElementById("canvas3d").addEventListener("touchend",h,!1);document.getElementById("controls").addEventListener("touchend",h,!1);document.getElementById("delete").addEventListener("delete",toggleFullScreen,!1)}function S(){return navigator.userAgent.match(/Android/i)||
navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1}function T(a){if(0==a){h[0]=0;h[1]=4;h[2]=1.5;var b=e.get_active_camera();A.append_semi_soft(b,k,h,.2)}1==a&&(h[0]=0,h[1]=55,h[2]=-3,b=e.get_active_camera(),A.append_semi_soft(b,R,h,.2));2==a&&(h[0]=0,h[1]=18,h[2]=-7,b=e.get_active_camera(),A.append_semi_soft(b,
_cam_target_2,h,0));3==a&&(h[0]=0,h[1]=2,h[2]=-2,b=e.get_active_camera(),A.append_semi_soft(b,_cam_target_3,h,0))}var ma=c("container"),p=c("animation"),za=c("app"),I=c("config"),da=c("data"),a=c("controls"),ua=c("physics"),A=c("constraints"),e=c("scenes"),z=e,y=c("vec3"),ta=y.create(),f=c("transform"),Aa=c("quat");c("objects");var W=c("mouse");c("tsr");c("debug");var sa=c("time"),E=c("logic_nodes"),aa=y.create(),Z=0,D=new Float32Array(3),B=new Float32Array(3),n=new Float32Array(3),Y=0,x=0,U=a.create_elapsed_sensor(),
r=document.createElement("div"),q=document.createElement("div"),t=document.createElement("div"),u=document.createElement("div"),v=document.createElement("div"),w=document.createElement("div"),k=null,m=null,R=null,h=new Float32Array([0,4,1.5]),H=0,F=0,l,X,G=0,na=y.create();y.create();Aa.create();var J=0,ka=new Float32Array(999);ba.init=function(){za.init({canvas_container_id:"canvas3d",callback:ca,physics_enabled:!0,quality:S()?I.P_LOW:I.P_HIGH,show_fps:!0,autoresize:!0,alpha:!1})}});b4w.require("example2_main").init();
